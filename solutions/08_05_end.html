<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>08_05 - D3.js Essential Training</title>
    <script src="https://d3js.org/d3.v7.min.js"></script> <!-- Import D3 first -->
    <style>
            html,body {height: 100%; width: 100%;}
            html,body,blockquote,li,a,div,section,code,h1,h2,h3,h4,h5,h6,p,pre{margin:0;padding:0;font-family: "Noto Serif", "serif"}
            line { stroke: red; }
            g.tick line {stroke: orange; } 
            g.tick text { font-size:12px; fill: orange; }
            .g2 path { fill: pink; }
    </style>
</head>
<body>
    <script>
        const margin = {"right": 50, "top": 50, "bottom": 50, "left": 50}

        let width = document.documentElement.clientWidth ;
        let height = document.documentElement.clientHeight;

        const svg = d3.select("body")
            .append("svg")
            .attr("width", "100%")
            .attr("height", "100%")
            .attr("viewBox", "0 0 " + width + " " + height)
            .attr("preserveAspectRatio", "xMidYMid meet");

        height -= margin.top + margin.bottom;
        width -= margin.left + margin.right;        

        const g = svg.append("g").attr("id","chart").attr("transform","translate("+margin.left+","+margin.top+")");

        const generatedData = generateData();
        console.log(generatedData);

        const groupedData = d3.group(generatedData, d=>d.Month);
        console.log(groupedData);

        const rolledupData = d3.rollup(generatedData, 
            v => d3.sum(v, d=>d.Value),
            d => d.Month
        );

        console.log(rolledupData);






    function generateData() {
        const data = [];
        const startDate = new Date('2023-01-01'); // Start date
        const months = ['January', 'February', 'March', 'April']; // Array of months
        let value = 100; // Starting value for "Value"

        // Loop over the months and generate data
        for (let monthIndex = 0; monthIndex < months.length; monthIndex++) {
            for (let day = 1; day <= 31; day++) {
            // Create date for the current month and day
            const currentDate = new Date(startDate.getFullYear(), monthIndex, day);

            // If the date exceeds the current month's length, break
            if (currentDate.getMonth() !== monthIndex) break;

            // Generate value, here we're just incrementing it for simplicity
            value = Math.floor(Math.random() * 20) + value;

            // Push the data for each date
            data.push({
                Date: currentDate,
                Value: value,
                Month: months[monthIndex] // Assign the corresponding month name
            });
            }
        }

        return data;
        }

    </script>
</body>
</html>
